.. tags: Meetings
.. slug: 84-crash-bang-wallop-collisions
.. title: Crash, Bang, Wallop! – Collisions
.. date: 13 July 2016 11:05
.. author: Edward Powell


<p><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: left; padding-top: 0px; padding-left: 0px; margin: 6px; display: inline; padding-right: 0px; border-top-width: 0px" alt="image" src="../../../images/old/image_thumb_af7d5056a36369ffd45eb6f161b41c08.png" border="0" align="left" height="164" width="244">This
 session we are going to add collision detection between our particles 
and make them ‘bounce’ off one another. This will actually come down to 3
 separate tasks. </p>  <p>Firstly we need to know when to particles have collided (collision testing, or detection). </p>  <p>Secondly
 we need to change the behaviour of the particles to respond to the 
collision - for now this will simply be to make them bounce apart. </p>  <p>Thirdly
 we need to catch a tricky problem common to all physics simulations – 
stickiness! Because we will be testing for collisions at discrete 
moments in time (whenever our collide function is called in the main 
game loop) there are going to be occasions where we have just missed the
 actual moment of collision. At this point our particles will be 
overlapping and begin to repeatedly trigger our collision test make the 
particles ‘bounce’ constantly in opposite directions each call – the 
visual effect of this will be to make the particles appear stuck 
together. To avoid this problem we will also add a bit of code to ensure
 that, in addition to causing the particles to bounce, we also make sure
 we remove any overlap.</p>  <h2>Checking all the particles once, but only once!</h2>  <p>Lets
 start with how we are going to call our collision code. Naively, for 
each particle we could just insert a second loop to check against the 
particle list particle by particle – but wait… A simple nested loop will
 actually check every *<strong>pair</strong>* of particles twice – A 
with B, and then later B with A. We want to avoid this duplication as 
well as avoid checking particles against themselves – A with A and B 
with B etc.</p>  <p>To achieve this we will use a modified internal loop that only checks the particle against the other particles *<strong>that are later in the list</strong>*.
 To do this we need to modify the way we loop through the list in the 
outer loop so that we can keep track of the position in the list of the 
particle we are currently checking. Find the existing update-draw loop 
for each particle and replace it with this code:</p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#0000ff">for</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> i</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> particle </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#0000ff">in</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> enumerate</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">my_particles</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">):</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">particle</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">move</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">()</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt"><span style="mso-spacerun: yes">&nbsp;&nbsp; </span>particle</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">bounce</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">()</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#0000ff">for</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> particle2 </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#0000ff">in</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> my_particles</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">[</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">i</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">+</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#ff0000">1</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">:]:</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">collide</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">particle</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> particle2</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">)</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">particle</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">display</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">()</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p>Can you see how this works? <em>Enumerating</em> the particle list means that the variable <strong><em>i</em></strong> will keep track of the index of each particle in the list as we iterate through it. We can use <strong><em>i</em></strong> to begin the nested for loop from 1 place further on in the list than the particle being tested. The function that we call – <em>collide</em> – will test to see if the pair of particles are in collision and act upon them if they are. Let’s look at that next.</p>  <h2>Collision Testing &amp; Handling</h2>  <p>The collide function should be added under the existing <em>findParticle</em> function, before the <em>Particle</em> class definition. Here is the collision code in its entirety:</p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#0000ff"><font style="font-size: 10pt">def</font></font></span></b><font style="font-size: 10pt"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#ff00ff">collide</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">):</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">dx </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">x </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">-</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000">x</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">dy </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">y </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">-</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000">y</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&nbsp;</font></font></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">dist </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> math</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">hypot</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">dx</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> dy</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">)</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#0000ff">if</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> dist </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">&lt;</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">size </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">+</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">size</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">:</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">tangent </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> math</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">atan2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">dy</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> dx</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">)</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">angle </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#ff0000">0.5</font></span><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">*</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> math</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">pi </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">+</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000"> tangent</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&nbsp;</font></font></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">angle1 </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#ff0000">2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">*</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">tangent </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">-</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000">angle</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">angle2 </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#ff0000">2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">*</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">tangent </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">-</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000">angle</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">speed1 </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">speed</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">*</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000">elasticity</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">speed2 </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">speed</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">*</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000">elasticity</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&nbsp;</font></font></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">angle</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">speed</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">)</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">angle1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> speed1</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">)</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">angle</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">speed</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">)</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">angle2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">,</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> speed2</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000080">)</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&nbsp;</font></font></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span></span><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#008000"># Move overlapping particles apart</font></span></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">separation </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">p1</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">size </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">+</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> p2</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">size </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">-</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> dist</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">)</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">/</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#ff0000">2.0</font></span></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">x_separation </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> math</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">sin</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">angle</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">)</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">*</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000"> separation</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">y_separation </font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">=</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> math</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">cos</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">(</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">angle</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">)</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"> </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">*</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000"> separation</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">p1</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">x </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">+=</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000"> x_separation</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">p1</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">y </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">-=</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000"> y_separation</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">p2</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">x </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">-=</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000"> x_separation</font></span></font></p>  <p class="MsoNormal" style="background: white; margin: 0cm 0cm 0pt; line-height: normal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 10pt">p2</font></font></span><font style="font-size: 10pt"><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">.</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000000">y </font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font color="#000080">+=</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"><font style="font-size: 10pt" color="#000000"> y_separation</font></span></font><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: en-gb; mso-fareast-language: en-gb"></span></p>  <p>Initially you can see that we simply find the difference in x positions (<em>dx</em>) between the particles’ centres and the difference in y (<em>dy</em>). We use basic Pythagoras to find the distance between the centres of the particles (the hypotenuse of the dx dy triangle).</p>  <p>The
 collision test is now simply to see if this distance is less than the 
combined sizes of the particles – this should all be familiar to those 
of you who worked through the asteroids game.</p>  <p>If there is a 
collision, we change each particle’s movement angle and make them appear
 to bounce – I will go through the theory in the session.</p>  <h2>Parting is such sweet sorrow</h2>  <p>Finally,
 we need to deal with the ‘sticky’ problem of intersecting. If, at the 
moment we check them, the particles have already overlapped, then simply
 changing their speeds and angles is going to leave us in a tricky 
state. On the very next loop around our code, and despite the fact that 
they are now moving apart, we may well find them in collision again 
(because they were overlapped) and ‘bounce’ them again… and again… and 
again. This causes a very obvious glitch. To solve it we must ensure 
that we not only leave our particles moving apart, but also ensure that 
they are forcibly separated before the next time around the loop. We do 
this in the code by finding the separation required to ensure that the 
particles are *not* overlapped and then we simply force their positions 
apart by setting the particles’ x y values directly.</p>  <p>Once you 
have the code working, try commenting this section of code out and see 
what happens without it, Can you see and understand why the problem 
occurs? It’s a good one to think about as similar issues can often turn 
up in timing, or sampling, loops.</p>  <h2>Projects for the Holiday</h2>  <p>Hopefully
 you can see that you have an interesting ‘engine’ for a whole variety 
of games at the end of this session – see what you can do with it over 
the summer and I look forward to playing some of your games next term.</p>



